{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Docker: Build All Images",
      "type": "shell",
      "command": "docker-compose build",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": true,
        "clear": false
      },
      "problemMatcher": []
    },
    {
      "label": "Docker: Start Cluster",
      "type": "shell",
      "command": "docker-compose up -d",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Docker: Stop Cluster",
      "type": "shell",
      "command": "docker-compose down",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Docker: View Logs",
      "type": "shell",
      "command": "docker-compose logs -f",
      "isBackground": true,
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated"
      },
      "problemMatcher": []
    },
    {
      "label": "Python: Validate Environment",
      "type": "shell",
      "command": "python",
      "args": ["scripts/orchestrator.py", "validate", "env"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Python: Validate Configs",
      "type": "shell",
      "command": "python",
      "args": ["scripts/orchestrator.py", "validate", "configs"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Python: Code Quality Audit",
      "type": "shell",
      "command": "python",
      "args": ["scripts/orchestrator.py", "audit", "code"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Python: Check Dependencies",
      "type": "shell",
      "command": "python",
      "args": ["scripts/orchestrator.py", "audit", "deps"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Web: Start Dev Server",
      "type": "shell",
      "command": "npm",
      "args": ["run", "dev"],
      "options": {
        "cwd": "${workspaceFolder}/dashboard"
      },
      "isBackground": true,
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*)\\((\\d+|\\d+,\\d+|\\d+,\\d+,\\d+,\\d+)\\):\\s+(error|warning|info)\\s+(TS\\d+)\\s*:\\s*(.*)$",
          "file": 1,
          "location": 2,
          "severity": 3,
          "code": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*",
          "endsPattern": ".*Local:.*"
        }
      }
    },
    {
      "label": "Web: Build Production",
      "type": "shell",
      "command": "npm",
      "args": ["run", "build"],
      "options": {
        "cwd": "${workspaceFolder}/dashboard"
      },
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": ["$tsc"]
    },
    {
      "label": "API: Start Server",
      "type": "shell",
      "command": "npm",
      "args": ["start"],
      "options": {
        "cwd": "${workspaceFolder}/api"
      },
      "isBackground": true,
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "dedicated"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^([^\\s].*):(\\d+):(\\d+)\\s+-\\s+(error|warning|info)\\s+(.*)$",
          "file": 1,
          "line": 2,
          "column": 3,
          "severity": 4,
          "message": 5
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": ".*",
          "endsPattern": ".*Server listening.*"
        }
      }
    },
    {
      "label": "Make: Run Target",
      "type": "shell",
      "command": "make",
      "args": ["${input:makeTarget}"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "Python: Run Current File",
      "type": "shell",
      "command": "python",
      "args": ["${file}"],
      "group": "test",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Switch Profile",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Set-McpProfile.ps1",
      "args": ["-Profile", "${input:mcpProfile}"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Switch to Core Profile",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Set-McpProfile.ps1",
      "args": ["-Profile", "core"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Switch to Fullstack Profile",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Set-McpProfile.ps1",
      "args": ["-Profile", "fullstack"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Switch to Testing Profile",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Set-McpProfile.ps1",
      "args": ["-Profile", "testing"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Switch to Data Profile",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Set-McpProfile.ps1",
      "args": ["-Profile", "data"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Switch to All Servers",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Set-McpProfile.ps1",
      "args": ["-Profile", "all"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Show Current Profile",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Get-McpProfile.ps1",
      "args": ["-Detailed"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Generate Profiles",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\New-McpProfiles.ps1",
      "args": ["-Force"],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Test Server Health",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Test-McpServers.ps1",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "label": "MCP: Compare Profiles",
      "type": "shell",
      "command": ".\\scripts\\powershell\\mcp\\Compare-McpProfiles.ps1",
      "args": [
        "-Profile1",
        "${input:mcpProfile1}",
        "-Profile2",
        "${input:mcpProfile2}",
        "-ShowServers"
      ],
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared"
      },
      "problemMatcher": []
    },
    {
      "type": "shell",
      "problemMatcher": [],
      "presentation": {
        "focus": true,
        "clear": true,
        "panel": "shared",
        "echo": true,
        "reveal": "always"
      },
      "command": ".\\scripts\\powershell\\security\\Initialize-DockerSecrets.ps1",
      "label": "Security: Setup Docker Secrets"
    },
    {
      "type": "shell",
      "problemMatcher": [],
      "presentation": {
        "focus": true,
        "clear": true,
        "panel": "shared",
        "echo": true,
        "reveal": "always"
      },
      "command": ".\\scripts\\powershell\\security\\Test-DockerSecrets.ps1",
      "label": "Security: Validate Secrets"
    },
    {
      "args": ["-SecretName", "${input:secretToRotate}"],
      "type": "shell",
      "command": ".\\scripts\\powershell\\security\\Update-DockerSecret.ps1",
      "label": "Security: Rotate Secret",
      "problemMatcher": [],
      "presentation": {
        "focus": true,
        "clear": true,
        "panel": "shared",
        "echo": true,
        "reveal": "always"
      }
    }
  ],
  "inputs": [
    {
      "id": "makeTarget",
      "type": "pickString",
      "description": "Select Make target",
      "options": [
        "build",
        "up",
        "dev",
        "down",
        "restart",
        "logs",
        "ps",
        "validate",
        "validate-configs",
        "validate-env",
        "test-all",
        "test-health",
        "test-conn",
        "clean"
      ],
      "default": "up"
    },
    {
      "id": "mcpProfile",
      "type": "pickString",
      "description": "Select MCP profile to switch to",
      "options": ["core", "fullstack", "testing", "data", "all"],
      "default": "core"
    },
    {
      "id": "mcpProfile1",
      "type": "pickString",
      "description": "Select first MCP profile to compare",
      "options": ["core", "fullstack", "testing", "data"],
      "default": "core"
    },
    {
      "id": "mcpProfile2",
      "type": "pickString",
      "description": "Select second MCP profile to compare",
      "options": ["core", "fullstack", "testing", "data"],
      "default": "fullstack"
    },
    {
      "id": "secretToRotate",
      "type": "pickString",
      "description": "Select secret to rotate",
      "options": [
        "postgres_user",
        "postgres_password",
        "redis_password",
        "mariadb_root_password",
        "mariadb_password",
        "mariadb_user"
      ],
      "default": "postgres_password"
    }
  ]
}
